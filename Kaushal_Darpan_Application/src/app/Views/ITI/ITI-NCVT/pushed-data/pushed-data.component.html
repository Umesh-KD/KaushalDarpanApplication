
<div class="flex items-center justify-between flex-wrap gap-2 mb-6">
  <div>
    <h4 class="text-slate-900 text-lg font-medium mb-2">ITIs</h4>

    <div class="md:flex hidden items-center gap-3 text-sm font-semibold">
      <a routerLink="/dashboard" class="text-sm font-medium text-slate-700">Dashboard</a>
      <i class="material-symbols-rounded text-xl flex-shrink-0 text-slate-500">chevron_right</i>
      <a routerLink="/ITICollegeMaster" class="text-sm font-medium text-slate-700" aria-current="page">ITIs</a>
    </div>
  </div>
</div>
<!-- Page Title End -->

<div class="card">
  <div class="card-body p-5">
    <div class="mb-8">
      <div class="flex justify-between flex-wrap items-center mb-3 p-3 py-2 bg-light">
        <b class="text-1xl-5"><i class="ti ti-search"></i> Enter Search Criteria</b>
        <a routerLink="/additi" class="btn bg-success btn-sm text-white">
          <i class="ti ti-plus"></i> Add New
        </a>
      </div>

      <div class="grid 2xl:grid-cols-4 xl:grid-cols-4 lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-3">
        <!-- <div>
          <label class="text-gray-800 text-sm font-medium inline-block mb-1">Search By Zone:</label>
          <select class="form-select" [(ngModel)]="searchrequest.ZoneID">
            <option value="0">Choose Option</option>
            <option value="1">ABC</option>
            <option value="2">DEF</option>
          </select>
        </div> -->
        <div>
          <label class="text-gray-800 text-sm font-medium inline-block mb-1">Search By District:</label>
          <select class="form-select w-full" name="ddlDistrictID" [(ngModel)]="searchrequest.DistrictID">
            <option value="0">Choose Option</option>
            <option *ngFor="let item of Districtlist" [value]="item.ID">{{item.Name}}</option>
          </select>
        </div>
        <div>
          <label class="text-gray-800 text-sm font-medium inline-block mb-1">
            Search By ITI Name: <span class="StarMarking">*</span>
          </label>
          <input type="text" class="form-input" placeholder="Enter Name:" [(ngModel)]="searchrequest.Name">
          <div *ngIf="isSubmitted && groupForm.controls.txtName.errors" class="text-danger">
            <p *ngIf="groupForm.controls.txtName.errors.required">This field is required .!</p>
          </div>
        </div>
        <div>
          <label class="text-gray-800 text-sm font-medium inline-block mb-1">
            Search By ITI Code: <span class="StarMarking">*</span>
          </label>
          <input type="text" class="form-input" placeholder="Enter Name:" [(ngModel)]="searchrequest.ItiCode">
          <div *ngIf="isSubmitted && groupForm.controls.txtName.errors" class="text-danger">
            <p *ngIf="groupForm.controls.txtName.errors.required">This field is required .!</p>
          </div>
        </div>
        <div>
          <label class="text-gray-800 text-sm font-medium inline-block mb-1">
            Search By Trade:
          </label>
          <select class="form-select w-full" name="ddlTrade" [(ngModel)]="searchrequest.TradeID">
            <option value="0" disabled selected hidden>Choose Option</option>
            <option *ngFor="let item of ItiTradeList" [value]="item.Id">{{item.TradeName}}</option>
          </select>
        </div>
        <div>
          <label class="text-gray-800 text-sm font-medium inline-block mb-1">
            Search By Block/Tehsil:
          </label>
          <select class="form-select w-full" name="ddlTehsilID" [(ngModel)]="searchrequest.TehsilID">
            <option value="0" disabled selected hidden>Choose Option</option>
            <option *ngFor="let item of Tehsillist" [value]="item.ID">{{item.Name}}</option>
          </select>
        </div>
        <div>
          <label class="text-gray-800 text-sm font-medium inline-block mb-1">
            Search By Fee Status:
          </label>
          <select class="form-select" [(ngModel)]="searchrequest.FeeStatus">
            <option value="-1">ALL</option>
            <option value="1" >Entered</option>
            <option value="0">Not Entered</option>
          </select>
        </div>
        <div>
          <label class="text-gray-800 text-sm font-medium inline-block mb-1">
            Search By ITI Type:
          </label>
          <select class="form-select" [(ngModel)]="searchrequest.ITItypeID">
            <option value="0">Choose Option</option>
            <option *ngFor="let item of ManagmentTypeList" value="{{item.InstitutionManagementTypeID}}">
              {{item.InstitutionManagementType}}
            </option>
          </select>
        </div>
        <!-- <div>
          <label class="text-gray-800 text-sm font-medium inline-block mb-1">
            Search By Exam Type:
          </label>
          <select class="form-select w-full" name="ddlTradeScheme" [(ngModel)]="searchrequest.ExamTypeId">
            <option value="0" hidden>Choose Option</option>
            <option *ngFor="let item of ITITradeSchemeList" [value]="item.ID">{{item.Name}}</option>
          </select>
        </div> -->
        <!-- <div>
          <label class="text-gray-800 text-sm font-medium inline-block mb-1">
            Search By Course:
          </label>
          <select class="form-select" id="CourseType" [(ngModel)]="searchrequest.CourseID">
            <option value="0">Choose Option</option>
            <option *ngFor="let item of CourseTypeList" [value]="item.StreamTypeID">{{item.StreamType}}</option>
          </select>
        </div> -->
        <div>
          <label class="text-gray-800 text-sm font-medium inline-block mb-1">
            Search By Status:
          </label>
          <select class="form-select" [(ngModel)]="searchrequest.Status">
            <option value="-1">ALL</option>
            <option value="1">Active</option>
            <option value="0">Inactive</option>
          </select>
        </div>
        <!-- <div>
          <label class="text-gray-800 text-sm font-medium inline-block mb-1">
            Search By Exam System:
          </label>
          <select class="form-select" [(ngModel)]="searchrequest.ExamSystemId">
            <option value="0">Choose Option</option>
            <option value="1">A</option>
            <option value="2">B</option>
          </select>
        </div> -->

      </div>
      <div class="text-center mb-2">
        <button type="button" class="btn bg-info text-white mt-6" (click)="GetAllData()">Search</button>
        <button type="button" class="btn bg-danger text-white mt-6" (click)="ResetSearch()">Reset</button>
      </div>
    </div>
    <div class="flex justify-between flex-wrap items-center mb-3 p-3 py-2 bg-light">
      <b class="text-1xl-5"><i class="ti ti-list"></i> Search Results</b>
      <div class="flex justify-end flex-wrap items-center">
        <a href="javascript:void(0);" class="btn bg-info btn-sm text-white" (click)="exportToExcel()"><i class="ti ti-download"></i> Download Reports in Execl</a>
        <!-- <a href="javascript:void(0);" class="btn bg-info btn-sm text-white"><i class="ti ti-download"></i> Download Reports in PDF</a> -->
      </div>
    </div>
    <div class="grid 2xl:grid-cols-4 xl:grid-cols-4 lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-3">
      <div class="">
        <select id="ddlConter" class="form-select  couterDropDown" [(ngModel)]="pageInTableSize" (change)="loadInTable()">
          <option value="50">50</option>
          <option value="100">100</option>
          <option value="500">500</option>
          <option value="1000">1000</option>
        </select>
      </div>
      <div class="">
      </div>
      <div class="">
      </div>
      <div class="">
        <input class="form-input" placeholder="Search..." [(ngModel)]="Table_SearchText" />
      </div>
    </div>
    <div class="overflow-x-auto mt-3">

      <table class="table table-border w-full table-auto" cellpadding="5">
        <thead class="bg-light/40 border-b border-gray-100 dark:bg-light/5 dark:border-b-gray-700 h-10">
          <tr>
            <th class="text-left">S No</th>
            <th class="text-left">Name</th>
            <th class="text-left">Email</th>
            <th class="text-left">SSO</th>
            <th *ngIf="sSOLoginDataModel.RoleID!=_EnumRole.DTETraing">Roll List / Admit Card</th>
            <th class="text-left">Fee Status</th>
            <th class="text-left">Modified</th>
            <th class="text-left">Status</th>
            <th class="text-left">Active/Inactive Remark</th>
            <th class="text-center">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let iti of paginatedInTableData | tableSearchFilter:Table_SearchText ; let i = index">
            <td align="left">{{ (startInTableIndex+1)+i}}</td>
            <td align="left">{{ iti.CollegeName }}</td>
            <td align="left">{{ iti.Email }}</td>
            <td align="left">{{ iti.Ssoid }}</td>
            <td align="center" *ngIf="sSOLoginDataModel.RoleID!=_EnumRole.DTETraing" >
              <div class="flex">
                <button class="dropdown mr-1" mat-raised-button [matMenuTriggerFor]="menu" style="width: 105px; padding: 5px;">
                  Roll List <i class="ti ti-chevron-down"></i>
                </button>

                <mat-menu #menu="matMenu">
                  First Semester
                  <button mat-menu-item [routerLink]="'/ITIDownloadRollNoList'"
                          [queryParams]="{ semid: 1, instID: iti.Id }"
                          matTooltip="Roll List First Semester">
                    <i class="ti ti-download"></i> First Semester
                  </button>
                  Second Semester
                  <button mat-menu-item [routerLink]="'/ITIDownloadRollNoList'"
                          [queryParams]="{ semid: 2, instID: iti.Id }"
                          matTooltip="Roll List Second Semester">
                    <i class="ti ti-download"></i> Second Semester
                  </button>
                  Third Semester
                  <button mat-menu-item [routerLink]="'/ITIDownloadRollNoList'"
                          [queryParams]="{ semid: 3, instID: iti.Id }"
                          matTooltip="Roll List Third Semester">
                    <i class="ti ti-download"></i> Third Semester
                  </button>
                  Fourth Semester
                  <button mat-menu-item [routerLink]="'/ITIDownloadRollNoList'"
                          [queryParams]="{ semid: 4, instID: iti.Id }"
                          matTooltip="Roll List Fourth Semester">
                    <i class="ti ti-download"></i> Fourth Semester
                  </button>
                </mat-menu>

                <button class="dropdown" mat-raised-button [matMenuTriggerFor]="menuAdmit" style="width: 130px; padding: 5px;">
                  Admit Cards <i class="ti ti-chevron-down"></i>
                </button>

                <mat-menu #menuAdmit="matMenu">
                  First Semester
                  <button mat-menu-item [routerLink]="'/ITIGenerateAdmitCard'"
                          [queryParams]="{ semid: 1, instID: iti.Id }"
                          matTooltip="Admit Cards First Semester">
                    <i class="ti ti-download"></i> First Semester Main
                  </button>
                  Second Semester
                  <button mat-menu-item [routerLink]="'/ITIGenerateAdmitCard'"
                          [queryParams]="{ semid: 2, instID: iti.Id }"
                          matTooltip="Admit Cards Second Semester">
                    <i class="ti ti-download"></i> Second Semester Main
                  </button>
                  Third Semester
                  <button mat-menu-item [routerLink]="'/ITIGenerateAdmitCard'"
                          [queryParams]="{ semid: 3, instID: iti.Id }"
                          matTooltip="Admit Cards Third Semester">
                    <i class="ti ti-download"></i> Third Semester Main
                  </button>
                  Fourth Semester
                  <button mat-menu-item [routerLink]="'/ITIGenerateAdmitCard'"
                          [queryParams]="{ semid: 4, instID: iti.Id }"
                          matTooltip="Admit Cards Fourth Semester">
                    <i class="ti ti-download"></i> Fourth Semester Main
                  </button>
                </mat-menu>
              </div>
            </td>
            <td align="left">
              <span [class.text-red]="iti.Status === 0" [class.text-green]="iti.Status === 1">
                {{ iti.FeePdf !== 0 ? 'Fee Completed' : 'Fee Pending' }}
              </span>
            </td>
            <td align="left">{{ iti.ModifyDate | date:'yyyy-MM-dd HH:mm:ss' }}</td>


            <td class="left">
              <div class="flex items-center">
                <span>{{ iti.ActiveStatus == 1 ? 'Active' : 'Inactive' }}</span>
                <div class="ms-2 actionBtns" style="max-width:auto;width:auto;min-width:auto;">

                  <a href="javascript:void(0);" title="{{ iti.ActiveStatus == 1 ? 'Inactive' : 'Active' }} ITI" (click)="btnActive_OnClick(iti.Id)">
                    <i class="ti ti-player-pause"></i>
                  </a>
                </div>
              </div>

            </td>
            <td [innerHtml]="iti.RemarkForStatus"></td>


            <td align="center">
              <div class="flex">

                <button class="dropdown mr-1" mat-raised-button [matMenuTriggerFor]="menuAction" style="width: 105px; padding: 5px;">
                  ACTION <i class="ti ti-chevron-down"></i>
                </button>

                <mat-menu #menuAction="matMenu">
                  <!-- First Semester -->
                  <button mat-menu-item [routerLink]="'/ItiCollegeUpdate'"
                          [queryParams]="{ id: iti.Id }"
                          matTooltip="Update ITI College Details">
                    <i class="ti ti-pencil"></i> Update Details of ITI
                  </button>

                  <!-- Second Semester -->
                  <button mat-menu-item
                          (click)="ResetSSOID(iti.Id,iti.Ssoid)"
                          matTooltip="Reset SSOID">
                    <i class="ti ti-refresh"></i> Reset SSOID
                  </button>

                  <!-- Third Semester -->
                  <button mat-menu-item matTooltip="Unlock Fee" (click)="UnlockFee(iti.Id,iti.FeePdf)">
                    <i [ngClass]="iti.FeePdf == 1 ? 'ti ti-lock-open' : 'ti ti-lock'"></i>
                    {{ iti.FeePdf == 1 ? 'Unlock Fee' : 'Lock Fee' }}

                  </button>


                  <!-- Fourth Semester -->
                  <button mat-menu-item (click)="DeleteDataById(iti.Id)"
                          matTooltip="Delete ITI">
                    <i class="ti ti-trash"></i> Delete
                  </button>

                  <!-- Fifth Semester -->
                  <button mat-menu-item
                          matTooltip="NCVT Mis">
                    <i class="ti ti-download"></i> NCVT Mis
                  </button>

                  <!-- Sixth Semester -->
                  <button mat-menu-item (click)="ViewandUpdate(MyModel_ViewTrades,iti.Id)"
                          matTooltip="View Trades">
                    <i class="ti ti-eye"></i> View Trades
                  </button>
                </mat-menu>
              </div>

            </td>
          </tr>
        </tbody>


      </table>

    </div>


    <!--pagination-->
    <div class="p-3 paginationBox flex items-center justify-end w-full">
      <span class="block">Record {{startInTableIndex+1}} - {{endInTableIndex}} of {{totalInTableRecord}}</span>
      <div class="paginationBoxItems flex items-center">
        <button (click)="firstInTablePage()" [disabled]="currentInTablePage==1">First</button>
        <button (click)="previousInTablePage()" [disabled]="currentInTablePage==1">Previous</button>
        <input type="number" min="1" max="{{totalInTablePage}}" title="Enter page no." [(ngModel)]="currentInTablePage"
               [disabled]="totalInTablePage==0" (change)="randamInTablePage()" />
        <span class="text-nowrap">Page {{currentInTablePage}} of {{totalInTablePage}}</span>
        <button (click)="nextInTablePage()" [disabled]="currentInTablePage==totalInTablePage || totalInTablePage==0">Next</button>
        <button (click)="lastInTablePage()" [disabled]="currentInTablePage==totalInTablePage || totalInTablePage==0">Last</button>
      </div>
    </div>
    <!--end pagination-->


  </div>
</div>

<ng-template #MyModel_ViewTrades let-modal
             class="w-full h-full fixed top-0 left-0 z-[80] transition-all duration-500 overflow-y-auto [--overlay-backdrop:static] hidden">
  <div class="modal-content">
    <div class="card">
      <div class="card-header flex justify-between  items-center">
        <b><i class="fa fa-plus"></i>College Trades</b>
        <button class="btn bg-info text-white" (click)="CloseModalPopup()"><i class="ti ti-x"></i></button>
      </div>
      <div class="card-body">
        <div class="mb-8">

          <div class="overflow-x-auto mt-3">

            <table class="table table-border w-full table-auto" cellpadding="5">
              <thead class="bg-light/40 border-b border-gray-100 dark:bg-light/5 dark:border-b-gray-700 h-10">
                <tr>
                  <th class="text-left">#</th>
                  <th class="text-left">College Name</th>
                  <th class="text-left">Trade Name</th>
                  <th class="text-left">Trade Scheme</th>
                  <th class="text-left">Trade Level</th>

                  <th class="text-left">Min Age Limit</th>
                  <th class="text-left">Only For Women</th>

                  <th class="text-left">Min Percentage In Science</th>
                  <th class="text-left">Min Percentage In Math</th>



                  <th class="text-left">Seats</th>
                  <!--<th class="text-left">Original Seats</th>-->
                  <th class="text-left">Fee Per Year</th>
                  <th class="text-left">IMC Fee Per Year</th>
                  <!-- <th class="text-center">Action</th> -->
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let row of CollegeTradeList; let i = index">
                  <td align="left">{{ i + 1 }}</td>
                  <td align="left">{{row.CollegeName}}</td>
                  <td align="left">{{row.TradeName}}</td>
                  <td align="left">{{row.TradeScheme}}</td>
                  <td align="left">{{row.TradeLevelId}}</td>
                  <td align="left">{{row.MinAgeLimit}}</td>
                  <td align="left">{{row.OnlyForWomen}}</td>
                  <td align="left">{{row.MinPercentageInScience}}</td>
                  <td align="left">{{row.MinPercentageInMath}}</td>
                  <td align="left">{{row.TotalSeats}}</td>
                  <!--<td align="left">{{row.OriginalSeats}}</td>-->
                  <td align="left">{{row.Fee}}</td>
                  <td align="left">{{row.ImcFee}}</td>
                  <!-- <td align="left"></td> -->

                </tr>
              </tbody>


            </table>

          </div>
        </div>
      </div>
      <div class="grid 2xl:grid-cols-1 xl:grid-cols-1 lg:grid-cols-1 md:grid-cols-1 grid-cols-1 gap-3">
        <!-- <div class="text-center mb-2">
          <button type="button" class="btn bg-info text-white mt-6" (click)="appointStaffAsExaminer()">Submit</button>
        </div> -->
      </div>
    </div>
  </div>
</ng-template>
