<div class="flex items-center justify-between flex-wrap gap-2 mb-6">
  <div>
    <h4 class="text-slate-900 text-lg font-medium mb-2">{{searchRequest.TradeLevel}}th ITI Allotment</h4>
    <div class="md:flex hidden items-center gap-3 text-sm font-semibold">
      <a routerLink="/dashboard-Institute" class="text-sm font-medium text-slate-700">ITI</a>
      <i class="material-symbols-rounded text-xl flex-shrink-0 text-slate-500">chevron_right</i>
      <a href="javascript:void(0);" class="text-sm font-medium text-slate-700" aria-current="page">ITI Allotment</a>
    </div>
  </div>

</div>
<!-- Page Title End -->


<div class="card">
  <div class="card-body p-5">
    <div class="mb-8">
      <!--<div class="flex justify-between flex-wrap items-center mb-3 p-3 py-2 bg-light">
        <b class="text-1xl-5"><i class="ti ti-search"></i> Enter Search Criteria</b>
      </div>-->
      <form [formGroup]="ITIAllotmentFormGroup">
        <div class="grid 2xl:grid-cols-4 xl:grid-cols-4 lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-3">
          <!--<div>
            <label class="text-gray-800 text-sm font-medium inline-block mb-1">
              Trade Lavel: <span class="StarMarking">*</span>
            </label>
            <select class="form-select" formControlName="ClassId" id="ddlClass" [(ngModel)]="request.TradeLevel">
              <option value=0>--Select--</option>
              <option value="8">8th</option>
              <option value="10">10th</option>
            </select>
          </div>-->

          <div>
            <label class="text-gray-800 text-sm font-medium inline-block mb-1">Allotment Type: <span class="StarMarking">*</span></label>
            <select class="form-select" formControlName="AllotmentId" name="AllotmentId" (change)="startSubscription()" [(ngModel)]="request.AllotmentId">
              <option value="0">--Select--</option>
              <option value=2>First Allotment</option>
            </select>
            <!--<div *ngIf="ITIAllotmentFormGroup.get('AllotmentId').hasError('required') && ITIAllotmentFormGroup.get('AllotmentId').touched" class="text-danger">
              This field is required.
            </div>-->
          </div>


          <div>
            <button type="button" class="btn bg-info text-white  mt-6" (click)="startSubscription()" [disabled]="Generatebtn"> Generate Allotment</button>
          </div>

        </div>
      </form>

      <div class="flex justify-between flex-wrap items-center mb-3 p-3 py-2 bg-light mt-4">
        <b class="text-1xl-5"><i class="ti ti-list"></i>  Allotment Progress</b>
      </div>


      <div class="overflow-x-auto mt-3">
        <table class="table table-border w-full table-auto" cellpadding="5">
          <thead class="bg-light/40 border-b border-gray-100 dark:bg-light/5 dark:border-b-gray-700 h-10">
            <tr>
              <th class="text-left">Id</th>
              <th class="text-left">Type</th>
              <th class="text-left">TotalApplication</th>
              <th class="text-left">TotalRuning</th>
              <th class="text-left">TotalAlloted</th>
              <th class="text-left">Time</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of AllotmentCounterList; let idx=index;  ">
              <td>{{idx+1}}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6" [innerHTML]="item.Type"></td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6">{{item.TotalApplication}}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6">{{item.TotalRuningCount}}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6">{{item.TotalAlloted}}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6">{{item.CompleteTime}}</td>
            </tr>
          </tbody>
        </table>
      </div>


      <div class="flex justify-between flex-wrap items-center mb-3 p-3 py-2 bg-light mt-4">
        <b class="text-1xl-5"><i class="ti ti-list"></i>  Allotment Data</b>
        <div>
          <button type="button" class="btn bg-info text-white" (click)="exportToExcel()"><i class="ti ti-download"></i> Download</button>
        </div>
      </div>

      <div class="grid 2xl:grid-cols-4 xl:grid-cols-4 lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-3">
        <div class="">
          <select id="ddlConter" class="form-select  couterDropDown" [(ngModel)]="pageSize" (change)="ShowAllotmentDataList(1)">
            <option [value]="50">50</option>
            <option [value]="100">100</option>
            <option [value]="500">500</option>
            <option [value]="1000">1000</option>
          </select>
        </div>
        <div class="">
        </div>
        <div class="">
        </div>
        <div class="">
          <input class="form-input" placeholder="Search..." [(ngModel)]="Table_SearchText" />
        </div>
      </div>
      <div class="w-100  bg-light my-2">
      </div>
      <div class="grid 2xl:grid-cols-4 xl:grid-cols-4 lg:grid-cols-4 md:grid-cols-1 grid-cols-1 gap-3">
        <div>
          <label class="">
            Allotment: <span class="StarMarking"></span>
          </label>
          <select class="form-select" id="actionid" name="actionid" (change)="ShowAllotmentDataList(1)" [(ngModel)]="searchRequest.action">
            <option value=''>--Select--</option>
            <option value="OPTION_FORM">OPTION FORM</option>
            <option value="ALLOTMENT_LIST">ALLOTMENT LIST</option>
            <option value="SEAT_METRIX">SEAT MATRIX</option>
            <option value="CUT_OFF">CUT OFF</option>
            <option value="COLLEGE_ALLOTMENT_COUNT">COLLEGE ALLOTMENT COUNT</option>
          </select>
        </div>
      </div>

      <div class="w-100  bg-light my-2">
      </div>
      <div class="w-100  bg-light my-2">
      </div>

      <div class="table-responsive">
        <table class="table table-border w-full table-auto" cellpadding="5">
          <thead *ngIf="searchRequest.action=='OPTION_FORM'">
            <tr>
              <th>SR</th>
              <th class="text-left">Merit No</th>
              <th class="text-left">CollegeName                </th>
              <th class="text-left">BranchName                 </th>
              <th class="text-left">Priority                   </th>
              <th class="text-left">Application No</th>
              <th class="text-left">Applicant Name</th>
              <th class="text-left">Gender</th>
              <th class="text-left">DOB</th>
              <th class="text-left">Category</th>
              <th class="text-left">PH</th>
              <th class="text-left">KM</th>
              <th class="text-left">Ex Servicemen</th>
              <th class="text-left">Widow/Divorcee</th>
              <th class="text-left">Single Mother Dependent</th>
              <th class="text-left">TSP</th>
              <th class="text-left" *ngIf="searchRequest.TradeLevel==1 || searchRequest.TradeLevel==2">Class Percentage</th>
              <th class="text-left" *ngIf="searchRequest.TradeLevel==3">Course Type</th>
              <th class="text-left" *ngIf="searchRequest.TradeLevel==3">12th Percentage</th>
              <th class="text-left" *ngIf="searchRequest.TradeLevel==3">10th Percentage</th>
              <th class="text-left">RAJ DOMICILE</th>
            </tr>
          </thead>
          <thead *ngIf="searchRequest.action=='ALLOTMENT_LIST'">
            <tr>
              <th>SR</th>
              <th class="text-left">Merit No</th>
              <th class="text-left">CollegeName                </th>
              <th class="text-left">BranchName                 </th>
              <th class="text-left">Alloted Priority                   </th>
              <th class="text-left">Alloted Category              </th>
              <th class="text-left">Alloted Gender</th>
              <th class="text-left">Application No</th>
              <th class="text-left">Applicant Name</th>
              <th class="text-left">Gender</th>
              <th class="text-left">DOB</th>
              <th class="text-left">Category</th>
              <th class="text-left">PH</th>
              <th class="text-left">KM</th>
              <th class="text-left">Ex Servicemen</th>
              <th class="text-left">Widow/Divorcee</th>
              <th class="text-left">Single Mother Dependent</th>
              <th class="text-left">TSP</th>
              <th class="text-left" *ngIf="searchRequest.TradeLevel==1 || searchRequest.TradeLevel==2">Class Percentage</th>
              <th class="text-left" *ngIf="searchRequest.TradeLevel==3">Course Type</th>
              <th class="text-left" *ngIf="searchRequest.TradeLevel==3">12th Percentage</th>
              <th class="text-left" *ngIf="searchRequest.TradeLevel==3">10th Percentage</th>
              <th class="text-left">RAJ DOMICILE</th>
            </tr>
          </thead>
          <thead *ngIf="searchRequest.action=='SEAT_METRIX'">
            <tr>
              <th>SR</th>
              <th class="text-left">CollegeName </th>
              <th class="text-left">BranchName  </th>
              <th class="text-left">TotalSeats  </th>
              <th class="text-left">GEN         </th>
              <th class="text-left">GEN_F       </th>
              <th class="text-left">SC          </th>
              <th class="text-left">SC_F        </th>
              <th class="text-left">ST          </th>
              <th class="text-left">ST_F        </th>
              <th class="text-left">TSP         </th>
              <th class="text-left">TSP_F       </th>
              <th class="text-left">OBC         </th>
              <th class="text-left">OBC_F       </th>
              <th class="text-left">EWS         </th>
              <th class="text-left">EWS_F       </th>
              <th class="text-left">MBC         </th>
              <th class="text-left">MBC_F       </th>
              <th class="text-left">TFWS        </th>
              <th class="text-left">WID_DIV     </th>
              <th class="text-left">EX          </th>
              <th class="text-left">KM          </th>
              <th class="text-left">PH          </th>
              <th class="text-left">MGM         </th>
              <th class="text-left">SMD         </th>
            </tr>
          </thead>
          <thead *ngIf="searchRequest.action=='CUT_OFF'">
            <tr>
              <th>SR</th>
              <th class="text-left">InstituteNameEnglish    </th>
              <th class="text-left">Name                    </th>
              <th class="text-left">AllotedGender           </th>
              <th class="text-left">AllotedCategory         </th>
              <th class="text-left">CutOff                  </th>

            </tr>
          </thead>
          <thead *ngIf="searchRequest.action=='COLLEGE_ALLOTMENT_COUNT'">
            <tr>
              <th>SR</th>
              <th class="text-left">InstituteNameEnglish      </th>
              <th class="text-left">Name                      </th>
              <th class="text-left">Total Seats                      </th>
              <th class="text-left">TotalAlloted              </th>
            </tr>
          </thead>




          <tbody *ngIf="searchRequest.action=='OPTION_FORM'">
            <tr *ngFor="let row of transactionData | tableSearchFilter:Table_SearchText; let idx=index;">
              <td>{{(pageSize * (pageNo - 1))+(idx+1)}}</td>
              <td class="text-left"> {{row.MeritNo }}</td>
              <td class="text-left"> {{row.CollegeName }} </td>
              <td class="text-left"> {{row.BranchName      }}  </td>
              <td class="text-left"> {{row.Priority}}          </td>
              <td class="text-left"> {{row.ApplicationID }}</td>
              <td class="text-left"> {{row.StudentName }}</td>
              <td class="text-left"> {{row.Gender }}</td>
              <td class="text-left"> {{row.DOB }}</td>
              <td class="text-left"> {{row.StudentCategory}} </td>
              <td class="text-left"> {{row.IsPH }}</td>
              <td class="text-left"> {{row.IsKM }}</td>
              <td class="text-left"> {{row.IsExServicemen }}</td>
              <td class="text-left"> {{row.IsWID}} </td>
              <td class="text-left"> {{row.IsSingleMotherDependent }}</td>
              <td class="text-left"> {{row.IsTSP }}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6" *ngIf="searchRequest.TradeLevel==1">{{row.TenthPer}}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6" *ngIf="searchRequest.TradeLevel==2">{{row.MaxPer}}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6" *ngIf="searchRequest.TradeLevel==3">{{row.CourseType}}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6" *ngIf="searchRequest.TradeLevel==3">{{row.TwelvePer}}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6" *ngIf="searchRequest.TradeLevel==3">{{row.TenthPer}}</td>
              <td class="text-left"> {{row.IsRajDOMICILE }}</td>




            </tr>
          </tbody>
          <tbody *ngIf="searchRequest.action=='ALLOTMENT_LIST'">
            <tr *ngFor="let row of transactionData | tableSearchFilter:Table_SearchText; let idx=index;">
              <td>{{(pageSize * (pageNo - 1))+(idx+1)}}</td>
              <td class="text-left"> {{row.MeritNo }}</td>
              <td class="text-left"> {{row.CollegeName }} </td>
              <td class="text-left"> {{row.BranchName      }}  </td>
              <td class="text-left"> {{row.AllotedPriority}}          </td>
              <td class="text-left"> {{row.AllotedCategory}}     </td>
              <td class="text-left"> {{row.AllotedGender }}</td>
              <td class="text-left"> {{row.ApplicationID }}</td>
              <td class="text-left"> {{row.StudentName }}</td>
              <td class="text-left"> {{row.Gender }}</td>
              <td class="text-left"> {{row.DOB }}</td>
              <td class="text-left"> {{row.StudentCategory}} </td>
              <td class="text-left"> {{row.IsPH }}</td>
              <td class="text-left"> {{row.IsKM }}</td>
              <td class="text-left"> {{row.IsExServicemen }}</td>
              <td class="text-left"> {{row.IsWID}} </td>
              <td class="text-left"> {{row.IsSingleMotherDependent }}</td>
              <td class="text-left"> {{row.IsTSP }}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6" *ngIf="searchRequest.TradeLevel==1">{{row.TenthPer}}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6" *ngIf="searchRequest.TradeLevel==2">{{row.MaxPer}}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6" *ngIf="searchRequest.TradeLevel==3">{{row.CourseType}}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6" *ngIf="searchRequest.TradeLevel==3">{{row.TwelvePer}}</td>
              <td class="lg:whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-6" *ngIf="searchRequest.TradeLevel==3">{{row.TenthPer}}</td>
              <td class="text-left"> {{row.IsRajDOMICILE }}</td>
            </tr>
          </tbody>
          <tbody *ngIf="searchRequest.action=='SEAT_METRIX'">

            <tr *ngFor="let row of transactionData | tableSearchFilter:Table_SearchText; let idx=index;">
              <td>{{(pageSize * (pageNo - 1))+(idx+1)}}</td>
              <td class="text-left"> {{row.CollegeName}} </td>
              <td class="text-left"> {{row.BranchName}}  </td>
              <td class="text-left"> {{row.TotalSeats}}  </td>
              <td class="text-left"> {{row.GEN}}  </td>
              <td class="text-left"> {{row.GEN_F}}  </td>
              <td class="text-left"> {{row.SC}}  </td>
              <td class="text-left"> {{row.SC_F}}  </td>
              <td class="text-left"> {{row.ST}}  </td>
              <td class="text-left"> {{row.ST_F}}  </td>
              <td class="text-left"> {{row.TSP}}  </td>
              <td class="text-left"> {{row.TSP_F}}  </td>
              <td class="text-left"> {{row.OBC}}   </td>
              <td class="text-left"> {{row.OBC_F}}   </td>
              <td class="text-left"> {{row.EWS}}   </td>
              <td class="text-left"> {{row.EWS_F}}   </td>
              <td class="text-left"> {{row.MBC}}   </td>
              <td class="text-left">  {{row.MBC_F   }}   </td>
              <td class="text-left">  {{row.TFWS    }}   </td>
              <td class="text-left">  {{row.WID_DIV }}   </td>
              <td class="text-left">  {{row.EX      }}   </td>
              <td class="text-left">  {{row.KM      }}   </td>
              <td class="text-left">  {{row.PH      }}   </td>
              <td class="text-left">  {{row.MGM     }}   </td>
              <td class="text-left">  {{row.SMD     }}   </td>
            </tr>
          </tbody>
          <tbody *ngIf="searchRequest.action=='CUT_OFF'">
            <tr *ngFor="let row of transactionData | tableSearchFilter:Table_SearchText; let idx=index;">
              <td>{{(pageSize * (pageNo - 1))+(idx+1)}}</td>
              <td class="text-left">{{row.InstituteNameEnglish}}    </td>
              <td class="text-left">{{row.Name}}                    </td>
              <td class="text-left">{{row.AllotedGender}}           </td>
              <td class="text-left">{{row.AllotedCategory}}         </td>
              <td class="text-left">{{row.CutOff}}                  </td>
            </tr>
          </tbody>
          <tbody *ngIf="searchRequest.action=='COLLEGE_ALLOTMENT_COUNT'">
            <tr *ngFor="let row of transactionData | tableSearchFilter:Table_SearchText; let idx=index;">
              <td>{{(pageSize * (pageNo - 1))+(idx+1)}}</td>
              <td class="text-left">{{row.InstituteNameEnglish}}      </td>
              <td class="text-left">{{row.Name}}                      </td>
              <td class="text-left">{{row.TotalSeats}}                      </td>
              <td class="text-left">{{row.TotalAlloted}}              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="p-3 paginationBox flex items-center justify-end w-full">
        <span class="block">
          Record {{ (pageNo - 1) * pageSize +  1 }} - {{ (pageNo - 1) * pageSize +  transactionData?.length }} of {{transactionData[0]?.TotalRecords}}
        </span>
        <div class="paginationBoxItems flex items-center">
          <button (click)="ShowAllotmentDataList(1)" [disabled]="pageNo==1">First</button>
          <button (click)="previousData()" [disabled]="pageNo==1">Previous</button>
          <input type="number" min="1" max="100" title="Enter page no." [(ngModel)]="pageNo"
                 [disabled]="transactionData[0]?.TotalRecords==0" (change)="ShowAllotmentDataList(pageNo)" />
          <span class="text-nowrap">Page {{pageNo}} of {{TotalPages}}</span>
          <button (click)="nextData()">Next</button>
          <button (click)="ShowAllotmentDataList(TotalPages)" [disabled]="pageNo==TotalPages || TotalPages==0">Last</button>
        </div>
      </div>
    </div>
  </div>

</div>
<!-- end row -->
